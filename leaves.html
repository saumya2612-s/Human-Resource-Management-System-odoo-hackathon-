<!DOCTYPE html>
<html>
<head>
<title>Leaves</title>
<link rel="stylesheet" href="style.css">
</head>

<body>

<div class="page-container">

<h2>Leave Management</h2>

<h3>Apply Leave</h3>

<input id="empId" placeholder="Employee ID">
<input id="type" placeholder="Leave Type (Sick / Paid / Casual)">
<label>From</label>
<input type="date" id="from">
<label>To</label>
<input type="date" id="to">

<button onclick="applyLeave()">Apply Leave</button>

<p id="msg"></p>

<hr>

<h3>Leave Records</h3>

<button onclick="getLeaves()">Load Leaves</button>

<table>
<thead>
<tr>
<th>ID</th>
<th>Employee</th>
<th>Type</th>
<th>From</th>
<th>To</th>
<th>Status</th>
</tr>
</thead>
<tbody id="data"></tbody>
</table>

<a href="dashboard_admin.html">Back</a>

</div>

<script>
async function applyLeave(){
const res = await fetch("http://localhost:5000/leaves",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
employee_id:document.getElementById("empId").value,
type:document.getElementById("type").value,
from_date:document.getElementById("from").value,
to_date:document.getElementById("to").value
})
});
const data = await res.json();
document.getElementById("msg").innerText=data.message;
}

async function getLeaves(){
const res = await fetch("http://localhost:5000/leaves");
const data = await res.json();

let r="";
data.forEach(l=>{
r+=`
<tr>
<td>${l.id}</td>
<td>${l.name}</td>
<td>${l.type}</td>
<td>${l.from_date}</td>
<td>${l.to_date}</td>
<td>${l.status}</td>
</tr>`;
});

document.getElementById("data").innerHTML=r;
}
</script>

</body>
</html>
